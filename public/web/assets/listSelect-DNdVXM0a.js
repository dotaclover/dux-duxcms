import{j as e}from"./vendor-map-DjDVTs0N.js";import{G as K,az as N}from"./vendor-refine-BK41FXO6.js";import{r as c}from"./vendor-react-BlTfyhut.js";import{y as S,Y as F,U as R,F as D}from"./modulepreload-polyfill-D6ThnDFs.js";import{B as k,J as T,F as V,I as B,T as I}from"./vendor-tdesign-BxQoi5Mo.js";const J=({options:u,resource:a,table:r,tableHook:p,tableColumns:n,filterRender:o,sort:i,idField:l="id",...m})=>{const f=K(),[h,x]=S(m),[g,s]=c.useState(!1),[j,w]=c.useState([]),{data:d}=N({resource:a,ids:h||[]});return c.useEffect(()=>{w((d==null?void 0:d.data)||[])},[d]),c.useEffect(()=>{x(j.map(t=>t==null?void 0:t[l]))},[j]),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{children:e.jsx(k,{variant:"outline",theme:"primary",onClick:()=>s(!0),icon:e.jsx("div",{className:"t-icon i-tabler:plus"}),children:f("common.select")})}),e.jsxs("div",{className:"mt-3",children:[e.jsx(F,{createAction:!1,deleteAction:!0,value:j,options:u||[],rowKey:l,onChange:t=>{w(t)},sort:i}),e.jsx(L,{open:g,onClose:()=>s(!1),table:r,tableHook:p,columns:n,resource:a,filterRender:o,onSelect:t=>{w(b=>{const y=b||[];return t==null||t.forEach(C=>{y.some(E=>E[l]==C[l])||y.push(C)}),[...y]})}})]})]})},L=({resource:u,columns:a,table:r,tableHook:p,open:n,onClose:o,onSelect:i,filterRender:l,idField:m="id"})=>{const f=K(),[h,x]=c.useState([]);return e.jsx(T,{header:f("common.select"),visible:n,onClose:o,className:"app-modal",destroyOnClose:!0,width:800,onConfirm:()=>{i==null||i(h),o==null||o()},children:e.jsx(z,{resource:u,columns:a,table:r,tableHook:p,filterRender:l,idField:m,onSelect:g=>x(g||[])})})},z=({resource:u,columns:a,table:r,tableHook:p,onSelect:n,filterRender:o,idField:i="id"})=>{const l=K(),m=c.useMemo(()=>a?[{colKey:"row-select",type:"multiple",width:50},...a]:[],[a]),{data:f,pagination:h,selecteds:x,setSelecteds:g,selectOptions:s,sorters:j,setSorters:w,filters:d,setFilters:t,tableFilters:b,setTableFilters:y,loading:C}=R({pagination:{current:0,pageSize:10},columns:m,rowKey:r==null?void 0:r.rowKey,resource:u,...p});return c.useEffect(()=>{n==null||n((s==null?void 0:s.selectedRowData)||[])},[s==null?void 0:s.selectedRowData]),e.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-0",children:[e.jsxs(V,{initialData:d,labelWidth:0,className:"app-filter flex-wrap",onValuesChange:E=>{t(E)},children:[e.jsx(D,{name:"keyword",children:e.jsx(B,{placeholder:l("common.placeholderKeyword")})}),o]}),e.jsx(I,{bordered:!0,rowKey:i,columns:m,data:f,cellEmptyContent:"-",stripe:!0,showSortColumnBgColor:!0,loading:C,pagination:{...h,className:"app-pagination"},sort:j,onSortChange:w,selectedRowKeys:x,onSelectChange:g,filterValue:b,onFilterChange:y,...r})]})};export{J as L};
