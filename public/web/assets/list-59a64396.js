import{_ as b}from"./index-4849d83d.js";import{Y as P,ac as M,ad as _,R as j,j as s,a9 as v,au as h,Z as C,ai as F,g as R,af as T,J as y,aj as k}from"./modulepreload-polyfill-d587593e.js";import{b as I,c as A,d as L,e as N,f as D,g as w,h as K,i as O,j as S,k as q,l as B,m as V,n as H,o as J,p as Y,q as Z,r as z,s as G,t as Q,v as U,a as f}from"./index-84384caa.js";import{M as W}from"./form-4b99e004.js";import{P as X}from"./index-ed80d7fc.js";import"./index-f4a3a35f.js";import"./index-332be4c0.js";import"./index-a6cf3464.js";import"./uploadImage-f9e400ea.js";const $=({magic:e,editResource:t,fields:o,component:l})=>{const c=[I(),A(),L(),N(),D(),w(),K(),O(),S(),q(),B(),V(),H(),J(),Y(),Z(),z(),G(),Q(),U()],i=P(),{mutate:d}=M(),{edit:x}=_(),p=j.useMemo(()=>{const n=[];o==null||o.map(r=>{c.map(u=>{!u||!r.list||u.name!=r.type||n.push(u.TableRender(r,i))})});const a=[{colKey:"link",title:i("table.actions"),fixed:"right",align:"center",width:120,cell:({row:r})=>s.jsxs("div",{className:"flex justify-center gap-4",children:[t?s.jsx(f,{theme:"primary",onClick:()=>x(t,r.id),children:i("buttons.edit")}):s.jsx(v,{title:i("buttons.edit"),trigger:s.jsx(f,{theme:"primary",children:i("buttons.edit")}),component:l,componentProps:{id:r.id,magic:e}}),s.jsx(X,{content:i("buttons.confirm"),destroyOnClose:!0,placement:"top",showArrow:!0,theme:"default",onConfirm:()=>{d({resource:"tools.data",id:r.id,meta:{params:{magic:e}}})},children:s.jsx(f,{theme:"danger",children:i("buttons.delete")})})]})}];return[...n,...a]},[i,o]),g=j.useMemo(()=>{var a;const n=(a=o==null?void 0:o.map((r,u)=>{if(!(r!=null&&r.search))return;const E=c.find(m=>m&&m.name==r.type&&(m==null?void 0:m.FilterRender));if(!(!E||!E.FilterRender))return s.jsx(E.FilterRender,{...r},u)}))==null?void 0:a.filter(r=>r!=null);return n&&n.length>0?s.jsx(s.Fragment,{children:n}):void 0},[o]);return{columns:p,filters:g}},ee=({data:e})=>{var p,g;const{params:t}=h(),o=P(),{create:l}=_(),{resource:c}=F(),{columns:i,filters:d}=$({fields:(p=e==null?void 0:e.data)==null?void 0:p.fields,magic:t==null?void 0:t.name,editResource:(g=e==null?void 0:e.data)!=null&&g.page?"tools.data":void 0,component:()=>b(()=>import("./modal-9429b6ee.js"),["assets/modal-9429b6ee.js","assets/modulepreload-polyfill-d587593e.js","assets/index-84384caa.js","assets/index-f4a3a35f.js","assets/index-332be4c0.js","assets/index-a6cf3464.js","assets/uploadImage-f9e400ea.js","assets/form-4b99e004.js"])});R.useEffect(()=>{var n;c!=null&&c.meta&&(c.meta.label=(n=e==null?void 0:e.data)==null?void 0:n.label)},[e]);const x=R.useMemo(()=>{var a,r;const n={rowKey:"id"};return((a=e==null?void 0:e.data)==null?void 0:a.type)=="common"&&(n.pagination=void 0),((r=e==null?void 0:e.data)==null?void 0:r.type)=="tree"&&(n.tree={childrenKey:"children",treeNodeColumnIndex:1,defaultExpandAll:!0},n.pagination=void 0),n},[e]);return s.jsx(T,{columns:i,tableHook:{meta:{params:{magic:t==null?void 0:t.name}}},table:x,actionRender:()=>{var n;return(n=e==null?void 0:e.data)!=null&&n.page?s.jsx(y,{icon:s.jsx("div",{className:"t-icon i-tabler:plus"}),onClick:()=>{l("tools.data")},children:o("buttons.create")}):s.jsx(v,{title:o("buttons.create"),trigger:s.jsx(y,{icon:s.jsx("div",{className:"t-icon i-tabler:plus"}),children:o("buttons.create")}),component:()=>b(()=>import("./modal-9429b6ee.js"),["assets/modal-9429b6ee.js","assets/modulepreload-polyfill-d587593e.js","assets/index-84384caa.js","assets/index-f4a3a35f.js","assets/index-332be4c0.js","assets/index-a6cf3464.js","assets/uploadImage-f9e400ea.js","assets/form-4b99e004.js"]),componentProps:{magic:t==null?void 0:t.name}})},filterRender:d?()=>d:void 0})},te=()=>{var l,c,i;const{params:e}=h(),{resource:t}=F(),{data:o}=C({url:"tools/magic/config",method:"get",meta:{params:{magic:e==null?void 0:e.name}}});return t!=null&&t.meta&&(t.meta.label=(l=o==null?void 0:o.data)==null?void 0:l.label),s.jsx(k,{formProps:{labelAlign:"top"},resource:"tools.dataPage",back:!0,id:0,action:"edit",useFormProps:{meta:{mode:"page"}},queryParams:{magic:e==null?void 0:e.name},children:((c=o==null?void 0:o.data)==null?void 0:c.fields)&&s.jsx(W,{fields:(i=o==null?void 0:o.data)==null?void 0:i.fields})})},me=()=>{const{params:e}=h(),{data:t}=C({url:"tools/magic/config",method:"get",meta:{params:{magic:e==null?void 0:e.name}}});return(t==null?void 0:t.code)!==200?null:(t==null?void 0:t.data.type)==="page"?s.jsx(te,{}):s.jsx(ee,{data:t})};export{me as default};
