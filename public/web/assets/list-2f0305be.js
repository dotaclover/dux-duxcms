import{_ as b}from"./index-27888db1.js";import{Y as P,ac as M,ad as _,R as j,j as s,a9 as v,ar as h,Z as F,ai as C,g as R,af as T,J as y}from"./modulepreload-polyfill-1cc1042d.js";import{F as k}from"./page-d7e14537.js";import{b as I,c as N,d as A,e as L,f as D,g as O,h as w,i as K,j as S,k as q,l as V,m as B,n as H,o as J,p as Y,q as Z,r as z,s as G,t as Q,v as U,a as E}from"./index-7256f177.js";import{M as W}from"./form-fa89c2c1.js";import{P as X}from"./index-f6a17ec9.js";import"./index-26810ad2.js";import"./index-9c2ee1aa.js";import"./index-ae91c890.js";import"./uploadImage-82d541ff.js";const $=({magic:e,editResource:t,fields:o,component:l})=>{const c=[I(),N(),A(),L(),D(),O(),w(),K(),S(),q(),V(),B(),H(),J(),Y(),Z(),z(),G(),Q(),U()],i=P(),{mutate:d}=M(),{edit:g}=_(),p=j.useMemo(()=>{const n=[];o==null||o.map(r=>{c.map(u=>{!u||!r.list||u.name!=r.type||n.push(u.TableRender(r,i))})});const a=[{colKey:"link",title:i("table.actions"),fixed:"right",align:"center",width:120,cell:({row:r})=>s.jsxs("div",{className:"flex justify-center gap-4",children:[t?s.jsx(E,{theme:"primary",onClick:()=>g(t,r.id),children:i("buttons.edit")}):s.jsx(v,{title:i("buttons.edit"),trigger:s.jsx(E,{theme:"primary",children:i("buttons.edit")}),component:l,componentProps:{id:r.id,magic:e}}),s.jsx(X,{content:i("buttons.confirm"),destroyOnClose:!0,placement:"top",showArrow:!0,theme:"default",onConfirm:()=>{d({resource:"tools.data",id:r.id,meta:{params:{magic:e}}})},children:s.jsx(E,{theme:"danger",children:i("buttons.delete")})})]})}];return[...n,...a]},[i,o]),f=j.useMemo(()=>{var a;const n=(a=o==null?void 0:o.map((r,u)=>{if(!(r!=null&&r.search))return;const x=c.find(m=>m&&m.name==r.type&&(m==null?void 0:m.FilterRender));if(!(!x||!x.FilterRender))return s.jsx(x.FilterRender,{...r},u)}))==null?void 0:a.filter(r=>r!=null);return n&&n.length>0?s.jsx(s.Fragment,{children:n}):void 0},[o]);return{columns:p,filters:f}},ee=({data:e})=>{var p,f;const{params:t}=h(),o=P(),{create:l}=_(),{resource:c}=C(),{columns:i,filters:d}=$({fields:(p=e==null?void 0:e.data)==null?void 0:p.fields,magic:t==null?void 0:t.name,editResource:(f=e==null?void 0:e.data)!=null&&f.page?"tools.data":void 0,component:()=>b(()=>import("./modal-05a91ec3.js"),["assets/modal-05a91ec3.js","assets/modulepreload-polyfill-1cc1042d.js","assets/index-7256f177.js","assets/index-26810ad2.js","assets/index-9c2ee1aa.js","assets/index-ae91c890.js","assets/uploadImage-82d541ff.js","assets/form-fa89c2c1.js"])});R.useEffect(()=>{var n;c!=null&&c.meta&&(c.meta.label=(n=e==null?void 0:e.data)==null?void 0:n.label)},[e]);const g=R.useMemo(()=>{var a,r;const n={rowKey:"id"};return((a=e==null?void 0:e.data)==null?void 0:a.type)=="common"&&(n.pagination=void 0),((r=e==null?void 0:e.data)==null?void 0:r.type)=="tree"&&(n.tree={childrenKey:"children",treeNodeColumnIndex:0,defaultExpandAll:!0},n.pagination=void 0),n},[e]);return console.log(g),s.jsx(T,{columns:i,tableHook:{meta:{params:{magic:t==null?void 0:t.name}}},table:g,actionRender:()=>{var n;return(n=e==null?void 0:e.data)!=null&&n.page?s.jsx(y,{icon:s.jsx("div",{className:"t-icon i-tabler:plus"}),onClick:()=>{l("tools.data")},children:o("buttons.create")}):s.jsx(v,{title:o("buttons.create"),trigger:s.jsx(y,{icon:s.jsx("div",{className:"t-icon i-tabler:plus"}),children:o("buttons.create")}),component:()=>b(()=>import("./modal-05a91ec3.js"),["assets/modal-05a91ec3.js","assets/modulepreload-polyfill-1cc1042d.js","assets/index-7256f177.js","assets/index-26810ad2.js","assets/index-9c2ee1aa.js","assets/index-ae91c890.js","assets/uploadImage-82d541ff.js","assets/form-fa89c2c1.js"]),componentProps:{magic:t==null?void 0:t.name}})},filterRender:d?()=>d:void 0})},te=()=>{var l,c,i;const{params:e}=h(),{resource:t}=C(),{data:o}=F({url:"tools/magic/config",method:"get",meta:{params:{magic:e==null?void 0:e.name}}});return t!=null&&t.meta&&(t.meta.label=(l=o==null?void 0:o.data)==null?void 0:l.label),s.jsx(k,{formProps:{labelAlign:"top"},resource:"tools.dataPage",back:!0,id:0,action:"edit",useFormProps:{meta:{mode:"page"}},queryParams:{magic:e==null?void 0:e.name},children:((c=o==null?void 0:o.data)==null?void 0:c.fields)&&s.jsx(W,{fields:(i=o==null?void 0:o.data)==null?void 0:i.fields})})},de=()=>{const{params:e}=h(),{data:t}=F({url:"tools/magic/config",method:"get",meta:{params:{magic:e==null?void 0:e.name}}});return(t==null?void 0:t.code)!==200?null:(t==null?void 0:t.data.type)==="page"?s.jsx(te,{},e==null?void 0:e.name):s.jsx(ee,{data:t},e==null?void 0:e.name)};export{de as default};
