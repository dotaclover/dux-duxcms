import{u as J,g as f,R as w,i as D,x as B,ai as M,aj as de,v as K,ak as fe,al as me,p as ve,F as ge,am as he,h as be,P as A,an as ye,U as Ce,ao as xe,a5 as je,O,ap as we,j as o,aq as E,ar as Pe}from"./modulepreload-polyfill-bcbe5797.js";import{u as H}from"./useSelect-df0bf3ed.js";import{F as Oe,a as S}from"./page-2d3d9f30.js";import{U as _e}from"./uploadImageManage-7b5370d4.js";import{E as Ie}from"./tinymce-243cff44.js";import"./index-801ac291.js";import{M as Ee}from"./form-a6df59da.js";import{C as Ne}from"./index-b00e17c7.js";import{T as ke}from"./index-ccd24792.js";import"./index-7aa59966.js";import"./manage-eb536151.js";import"./useUpload-3474a1a3.js";import"./index-cc4f2a4a.js";import"./index-da012b17.js";import"./index-1491da94.js";import"./cascader-918e64a1.js";import"./uploadFile-96119964.js";/**
 * tdesign v1.3.0
 * (c) 2023 tdesign
 * @license MIT
 */var Re={filterable:!0,highlightKeyword:!0,placeholder:void 0,size:"medium",status:"default"};/**
 * tdesign v1.3.0
 * (c) 2023 tdesign
 * @license MIT
 */var Q=function(l){var n=J(),e=n.classPrefix,u=l.content,C=l.keyword,b=f.useMemo(function(){var g;if(!u)return{list:[]};if(typeof u!="string"||!C)return{list:[u]};var m=new RegExp(C,"i"),y=(g=u.match(m))===null||g===void 0?void 0:g[0];return{list:u.split(y),keyword:y}},[u,C]);return w.createElement("div",{className:"".concat(e,"-select-option__highlight-item")},b.list.map(function(g,m){return m?[w.createElement("b",{className:"".concat(e,"-is-highlight"),key:g+b.keyword},b.keyword),g]:g}))};Q.displayName="HighlightOption";/**
 * tdesign v1.3.0
 * (c) 2023 tdesign
 * @license MIT
 */function U(t,l){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);l&&(e=e.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),n.push.apply(n,e)}return n}function G(t){for(var l=1;l<arguments.length;l++){var n=arguments[l]!=null?arguments[l]:{};l%2?U(Object(n),!0).forEach(function(e){B(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var X=f.forwardRef(function(t,l){var n=t.value,e=t.onSelect,u=t.popupVisible,C=J(),b=C.classPrefix,g=f.useState(""),m=D(g,2),y=m[0],P=m[1],x=f.useRef(-1),_="".concat(b,"-select__list"),V=["".concat(b,"-select-option"),B({},t.sizeClassNames[t.size],t.size)],j=f.useMemo(function(){var s=(t.options||[]).map(function(r){var h={};return typeof r=="string"?h={text:r,label:r}:(r.text&&typeof r.text!="string"&&M.warn("AutoComplete","`text` must be a string."),r.text?h=r:typeof r.label=="string"?h=G(G({},r),{},{text:r.label}):M.warn("AutoComplete","one of `label` and `text` must be a existed string.")),h});if(t.filter)s=s.filter(function(r){return t.filter(n,r)});else if(t.filterable){var p=new RegExp(n,"i");s=s.filter(function(r){return p.test(r.text)})}return s},[t.options,n,t.filterable]),z=function(p){for(var r=p.target;r&&r.tagName!=="LI";)r=r.parentNode;var h=r.getAttribute("title");P(h),e==null||e(h,{e:p})},F=function(p){if(p.code==="Enter"||p.key==="Enter")e==null||e(j[x.current].text,{e:p});else{var r,h=x.current,k;p.code==="ArrowUp"||p.key==="ArrowUp"?k=h-1<0?j.length-1:h-1:(p.code==="ArrowDown"||p.key==="ArrowDown")&&(k=h+1>=j.length?0:h+1),P((r=j[k])===null||r===void 0?void 0:r.text)}},N=function(){fe(document,"keydown",F)},I=function(){me(document,"keydown",F)};return f.useImperativeHandle(l,function(){return{addKeyboardListener:N,removeKeyboardListener:I}}),f.useEffect(function(){return u?N():I(),function(){I()}},[u]),f.useEffect(function(){n||P("")},[n]),f.useEffect(function(){x.current=j.findIndex(function(s){return s.text===y})},[y,j]),j.length?w.createElement("ul",{className:_},j.map(function(s){var p=[].concat(V);s.text===y&&p.push("".concat(b,"-select-option--hover"));var r=(de(s.label)?s.label():s.label)||s.text;return w.createElement("li",{key:s.text,className:K(p),title:s.text,onClick:z},typeof r=="string"&&t.highlightKeyword?w.createElement(Q,{content:r,keyword:n}):r)})):null});X.displayName="OptionsList";/**
 * tdesign v1.3.0
 * (c) 2023 tdesign
 * @license MIT
 */function q(t,l){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);l&&(e=e.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),n.push.apply(n,e)}return n}function v(t){for(var l=1;l<arguments.length;l++){var n=arguments[l]!=null?arguments[l]:{};l%2?q(Object(n),!0).forEach(function(e){B(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Y=f.forwardRef(function(t,l){var n,e=ve(t,Re),u=f.useRef(),C=f.useRef(),b=ge(e,"value",e.onChange),g=D(b,2),m=g[0],y=g[1],P=he(),x=P.classPrefix,_=P.sizeClassNames,V=be("input"),j=D(V,1),z=j[0],F=f.useState(!1),N=D(F,2),I=N[0],s=N[1],p=f.useRef(null);f.useImperativeHandle(l,function(){return{inputRef:u.current,popupRef:C.current}});var r=function(i,c){var a,L=i.getBoundingClientRect().width||i.offsetWidth||i.clientWidth,R=c.getBoundingClientRect().width||c.offsetWidth||c.clientWidth;return v({width:L>=R?"".concat(L,"px"):"auto"},(a=e.popupProps)===null||a===void 0?void 0:a.overlayInnerStyle)},h=["".concat(x,"-auto-complete")].concat(e.className),k=function(d){var i=["".concat(x,"-select__dropdown")];return(d=e.popupProps)!==null&&d!==void 0&&d.overlayClassName&&(i=i.concat(e.popupProps.overlayClassName)),K(i)}(),Z=function(d){var i=["".concat(x,"-select__dropdown-inner")];return(d=e.popupProps)!==null&&d!==void 0&&d.overlayInnerClassName&&(i=i.concat(e.popupProps.overlayInnerClassName)),K(i)}(),ee=function(i,c){y(i,c)},te=function(){var d=v({value:m,size:e.size},e.inputProps);return d}(),ne=function(i,c){var a;s(!0),(a=e.onFocus)===null||a===void 0||a.call(e,v(v({},c),{},{value:i}));var L=setTimeout(function(){var R;(R=p.current)===null||R===void 0||R.addKeyboardListener(),clearTimeout(L)},0)},re=function(i,c){var a;(a=e.onBlur)===null||a===void 0||a.call(e,v(v({},c),{},{value:i}))},oe=function(i,c){var a;(a=e.onEnter)===null||a===void 0||a.call(e,v(v({},c),{},{value:i}))},ae=function(i,c){var a;(a=e.onCompositionend)===null||a===void 0||a.call(e,v(v({},c),{},{value:i}))},ie=function(i,c){var a;(a=e.onCompositionstart)===null||a===void 0||a.call(e,v(v({},c),{},{value:i}))},le=function(i,c){var a;e.readonly||e.disabled||(s(!1),y(i,c),(a=e.onSelect)===null||a===void 0||a.call(e,i,c))},se=function(i,c){var a=c.trigger;a!=="trigger-element-click"&&s(i)},ce=e.triggerElement||e.children||w.createElement(A,v({ref:u,placeholder:(n=e.placeholder)!==null&&n!==void 0?n:z.placeholder,tips:e.tips,status:e.status,readonly:e.readonly,disabled:e.disabled,clearable:e.clearable,autofocus:e.autofocus,onClear:e.onClear,onChange:ee,onFocus:ne,onBlur:re,onEnter:oe,onCompositionend:ae,onCompositionstart:ie},te)),$=Array.isArray(e.options)&&w.createElement(X,{ref:p,value:m,options:e.options,size:e.size,sizeClassNames:_,onSelect:le,popupVisible:I,highlightKeyword:e.highlightKeyword,filterable:e.filterable,filter:e.filter}),T=e.panelTopContent,W=e.panelBottomContent,ue=T||$||W?w.createElement("div",{className:"".concat(x,"-autocomplete__panel")},T,$,W):null,pe=v(v({},e.popupProps),{},{overlayInnerStyle:r,overlayInnerClassName:Z,overlayClassName:k});return w.createElement("div",{className:K(h),style:e.style},w.createElement(ye,v({ref:C,visible:I,onVisibleChange:se,trigger:"focus",placement:"bottom-left",hideEmptyPopup:!0,content:ue},pe),ce))});Y.displayName="AutoComplete";/**
 * tdesign v1.3.0
 * (c) 2023 tdesign
 * @license MIT
 */var Se=Y;const Qe=()=>{const t=Ce(),{id:l}=xe(),{data:n,isLoading:e}=je({resource:"content.category"}),u=(n==null?void 0:n.data)||[],[C]=O.useForm(),b=O.useWatch("class_id",C),{request:g}=we(),[m,y]=f.useState();f.useEffect(()=>{if(!b){y(void 0);return}g(`content/category/${b}/magic`,"get").then(_=>{y((_==null?void 0:_.data)||{})})},[b]);const{options:P}=H({resource:"content.source",optionLabel:"name",optionValue:"id"}),{options:x}=H({resource:"content.recommend",optionLabel:"name",optionValue:"id"});return o.jsxs(Oe,{formProps:{labelAlign:"top"},back:!0,form:C,id:l,settingRender:o.jsxs(o.Fragment,{children:[o.jsx(O.FormItem,{label:t("content.article.fields.subtitle"),name:"subtitle",children:o.jsx(A,{})}),o.jsx(O.FormItem,{label:t("content.article.fields.image"),name:"images",children:o.jsx(_e,{accept:"image/*"})}),o.jsx(O.FormItem,{label:t("content.article.fields.imagesAuto"),name:"images_auto",initialData:!0,children:o.jsxs(E.Group,{children:[o.jsx(E,{value:!0,children:t("content.article.fields.auto")}),o.jsx(E,{value:!1,children:t("content.article.fields.manual")})]})}),o.jsx(O.FormItem,{label:t("content.article.fields.recommend"),name:"recommend",children:o.jsx(Pe.Group,{options:x})}),o.jsx(O.FormItem,{label:t("content.article.fields.source"),name:"source",children:o.jsx(Se,{options:P,highlightKeyword:!0,filterable:!1,clearable:!0})}),(m==null?void 0:m.fields)&&o.jsx(Ee,{fields:m==null?void 0:m.fields,prefix:"extend"}),o.jsx(O.FormItem,{label:t("content.article.fields.status"),name:"status",initialData:!0,children:o.jsxs(E.Group,{children:[o.jsx(E,{value:!0,children:t("content.article.tab.published")}),o.jsx(E,{value:!1,children:t("content.article.tab.unpublished")})]})})]}),children:[o.jsx(S,{name:"class_id",children:o.jsx(Ne,{loading:e,options:u,keys:{label:"name",value:"id"},clearable:!0,checkStrictly:!0,placeholder:t("content.article.validate.class")})}),o.jsx(S,{name:"title",children:o.jsx(A,{placeholder:t("content.article.validate.title")})}),o.jsx(S,{name:"content",children:o.jsx(Ie,{})}),o.jsx(S,{name:"keyword",children:o.jsx(A,{placeholder:t("content.article.validate.keywords")})}),o.jsx(S,{name:"descriptions",initialData:"",children:o.jsx(ke,{placeholder:t("content.article.validate.descriptions")})})]})};export{Qe as default};
