import{_ as b}from"./index-1fd01b2f.js";import{U as v,ae as M,ag as F,R as _,j as r,Y as j,au as R,a4 as T,ao as C,g as P,$ as k,H as y}from"./modulepreload-polyfill-ac150c65.js";import{F as I}from"./page-9aed038f.js";import{b as w,c as A,d as L,e as N,f as D,g as O,h as S,i as K,j as V,k as q,l as H,m as B,n as U,o as Y,p as $,q as z,r as G,s as J,t as Q,v as W,a as E}from"./index-fad5c14d.js";import{M as X}from"./form-30ca7331.js";import{P as Z}from"./index-0ed67c98.js";import"./select-79560333.js";import"./index-c55b5791.js";import"./index-5f5e664f.js";import"./cascader-482e42f6.js";import"./index-00aa768a.js";import"./uploadImage-0a68a97f.js";import"./useUpload-c49e3844.js";import"./tinymce-42857ea9.js";const ee=({magic:e,editResource:t,fields:o,componentEdit:u,componentShow:c})=>{const m=[w(),A(),L(),N(),D(),O(),S(),K(),V(),q(),H(),B(),U(),Y(),$(),z(),G(),J(),Q(),W()],n=v(),{mutate:x}=M(),{edit:g}=F(),h=_.useMemo(()=>{const a=[];o==null||o.map(s=>{m.map(d=>{!d||!s.list||d.name!=s.type||a.push(d.TableRender(s,n))})});const l=[{colKey:"link",title:n("table.actions"),fixed:"right",align:"center",width:160,cell:({row:s})=>r.jsxs("div",{className:"flex justify-center gap-4",children:[r.jsx(j,{title:n("buttons.show"),trigger:r.jsx(E,{theme:"primary",children:n("buttons.show")}),component:c,componentProps:{id:s.id,magic:e}}),t?r.jsx(E,{theme:"primary",onClick:()=>g(t,s.id),children:n("buttons.edit")}):r.jsx(j,{title:n("buttons.edit"),trigger:r.jsx(E,{theme:"primary",children:n("buttons.edit")}),component:u,componentProps:{id:s.id,magic:e}}),r.jsx(Z,{content:n("buttons.confirm"),destroyOnClose:!0,placement:"top",showArrow:!0,theme:"default",onConfirm:()=>{x({resource:"tools.data",id:s.id,meta:{params:{magic:e}}})},children:r.jsx(E,{theme:"danger",children:n("buttons.delete")})})]})}];return[...a,...l]},[o]),i=_.useMemo(()=>{var l;const a=(l=o==null?void 0:o.map((s,d)=>{if(!(s!=null&&s.search))return;const f=m.find(p=>p&&p.name==s.type&&(p==null?void 0:p.FilterRender));if(!(!f||!f.FilterRender))return r.jsx(f.FilterRender,{...s},d)}))==null?void 0:l.filter(s=>s!=null);return a&&a.length>0?r.jsx(r.Fragment,{children:a}):void 0},[o]);return{columns:h,filters:i}},te=({data:e})=>{var g,h;const{params:t}=R(),o=v(),{create:u}=F(),{resource:c}=C(),{columns:m,filters:n}=ee({fields:(g=e==null?void 0:e.data)==null?void 0:g.fields,magic:t==null?void 0:t.name,editResource:(h=e==null?void 0:e.data)!=null&&h.page?"tools.data":void 0,componentShow:()=>b(()=>import("./show-ac0311b1.js"),["assets/show-ac0311b1.js","assets/modulepreload-polyfill-ac150c65.js","assets/index-fad5c14d.js","assets/select-79560333.js","assets/index-c55b5791.js","assets/index-5f5e664f.js","assets/cascader-482e42f6.js","assets/index-00aa768a.js","assets/uploadImage-0a68a97f.js","assets/useUpload-c49e3844.js","assets/tinymce-42857ea9.js"]),componentEdit:()=>b(()=>import("./modal-eb3ded6c.js"),["assets/modal-eb3ded6c.js","assets/modulepreload-polyfill-ac150c65.js","assets/index-fad5c14d.js","assets/select-79560333.js","assets/index-c55b5791.js","assets/index-5f5e664f.js","assets/cascader-482e42f6.js","assets/index-00aa768a.js","assets/uploadImage-0a68a97f.js","assets/useUpload-c49e3844.js","assets/tinymce-42857ea9.js","assets/form-30ca7331.js"])});P.useEffect(()=>{var i;c!=null&&c.meta&&(c.meta.label=(i=e==null?void 0:e.data)==null?void 0:i.label)},[e]);const x=P.useMemo(()=>{var a,l;const i={rowKey:"id"};return((a=e==null?void 0:e.data)==null?void 0:a.type)=="common"&&(i.pagination=void 0),((l=e==null?void 0:e.data)==null?void 0:l.type)=="tree"&&(i.tree={childrenKey:"children",treeNodeColumnIndex:0,defaultExpandAll:!0},i.pagination=void 0),i},[e]);return r.jsx(k,{columns:m,tableHook:{meta:{params:{magic:t==null?void 0:t.name,action:"show"}}},table:x,actionRender:()=>{var i;return(i=e==null?void 0:e.data)!=null&&i.page?r.jsx(y,{icon:r.jsx("div",{className:"t-icon i-tabler:plus"}),onClick:()=>{u("tools.data")},children:o("buttons.create")}):r.jsx(j,{title:o("buttons.create"),trigger:r.jsx(y,{icon:r.jsx("div",{className:"t-icon i-tabler:plus"}),children:o("buttons.create")}),component:()=>b(()=>import("./modal-eb3ded6c.js"),["assets/modal-eb3ded6c.js","assets/modulepreload-polyfill-ac150c65.js","assets/index-fad5c14d.js","assets/select-79560333.js","assets/index-c55b5791.js","assets/index-5f5e664f.js","assets/cascader-482e42f6.js","assets/index-00aa768a.js","assets/uploadImage-0a68a97f.js","assets/useUpload-c49e3844.js","assets/tinymce-42857ea9.js","assets/form-30ca7331.js"]),componentProps:{magic:t==null?void 0:t.name}})},filterRender:n?()=>n:void 0})},oe=()=>{var u,c,m;const{params:e}=R(),{resource:t}=C(),{data:o}=T({url:"tools/magic/config",method:"get",meta:{params:{magic:e==null?void 0:e.name}}});return t!=null&&t.meta&&(t.meta.label=(u=o==null?void 0:o.data)==null?void 0:u.label),r.jsx(I,{formProps:{labelAlign:"top"},resource:"tools.dataPage",back:!0,id:0,action:"edit",useFormProps:{meta:{mode:"page"}},queryParams:{magic:e==null?void 0:e.name},children:((c=o==null?void 0:o.data)==null?void 0:c.fields)&&r.jsx(X,{fields:(m=o==null?void 0:o.data)==null?void 0:m.fields})})},xe=()=>{const{params:e}=R(),{data:t}=T({url:"tools/magic/config",method:"get",meta:{params:{magic:e==null?void 0:e.name}}});return(t==null?void 0:t.code)!==200?null:(t==null?void 0:t.data.type)==="page"?r.jsx(oe,{},e==null?void 0:e.name):r.jsx(te,{data:t},e==null?void 0:e.name)};export{xe as default};
