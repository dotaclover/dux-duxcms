import{u as J,g as f,R as w,ai as me,i as D,x as $,aj as H,ak as ve,v as K,al as ge,am as he,p as be,F as ye,an as Ce,h as xe,P as A,ao as je,U as we,ap as Pe,a5 as Oe,O,aq as Ee,j as o,ar as I,as as _e}from"./modulepreload-polyfill-ac2ad948.js";import{u as M}from"./useSelect-2ba2289c.js";import{F as Ie,a as k}from"./page-dcd37b5d.js";import{U as Re}from"./uploadImageManage-8eb86e61.js";import{E as Ne}from"./tinymce-fa480739.js";import"./index-9b4a0878.js";import{M as Se}from"./form-c049bf47.js";import{C as ke}from"./index-9069c2b5.js";import{T as Fe}from"./index-cb7df013.js";import"./index-b453100f.js";import"./manage-1e10d394.js";import"./useUpload-1230eea6.js";import"./index-952c5e1d.js";import"./index-59628e3a.js";import"./index-62e98837.js";import"./cascader-4c2f272d.js";import"./uploadFile-3289d450.js";/**
 * tdesign v1.4.1
 * (c) 2023 tdesign
 * @license MIT
 */var Le={filterable:!0,highlightKeyword:!0,placeholder:void 0,size:"medium",status:"default"};/**
 * tdesign v1.4.1
 * (c) 2023 tdesign
 * @license MIT
 */var De=me,Q=/[\\^$.*+?()[\]{}|]/g,Ke=RegExp(Q.source);function Ae(t){return t=De(t),t&&Ke.test(t)?t.replace(Q,"\\$&"):t}var X=Ae,Y=function(s){var n=J(),e=n.classPrefix,u=s.content,C=s.keyword,b=f.useMemo(function(){var g;if(!u)return{list:[]};if(typeof u!="string"||!C)return{list:[u]};var m=new RegExp(X(C),"i"),y=(g=u.match(m))===null||g===void 0?void 0:g[0];return{list:u.split(y),keyword:y}},[u,C]);return w.createElement("div",{className:"".concat(e,"-select-option__highlight-item")},b.list.map(function(g,m){return m?[w.createElement("b",{className:"".concat(e,"-is-highlight"),key:g+b.keyword},b.keyword),g]:g}))};Y.displayName="HighlightOption";/**
 * tdesign v1.4.1
 * (c) 2023 tdesign
 * @license MIT
 */function U(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);s&&(e=e.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),n.push.apply(n,e)}return n}function G(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?U(Object(n),!0).forEach(function(e){$(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Z=f.forwardRef(function(t,s){var n=t.value,e=t.onSelect,u=t.popupVisible,C=J(),b=C.classPrefix,g=f.useState(""),m=D(g,2),y=m[0],P=m[1],x=f.useRef(-1),E="".concat(b,"-select__list"),V=["".concat(b,"-select-option"),$({},t.sizeClassNames[t.size],t.size)],j=f.useMemo(function(){var i=(t.options||[]).map(function(r){var h={};return typeof r=="string"?h={text:r,label:r}:(r.text&&typeof r.text!="string"&&H.warn("AutoComplete","`text` must be a string."),r.text?h=r:typeof r.label=="string"?h=G(G({},r),{},{text:r.label}):H.warn("AutoComplete","one of `label` and `text` must be a existed string.")),h});if(t.filter)i=i.filter(function(r){return t.filter(n,r)});else if(t.filterable){var p=new RegExp(X(n),"i");i=i.filter(function(r){return p.test(r.text)})}return i},[t.options,n,t.filterable]),z=function(p){for(var r=p.target;r&&r.tagName!=="LI";)r=r.parentNode;var h=r.getAttribute("title");P(h),e==null||e(h,{e:p})},F=function(p){if(p.code==="Enter"||p.key==="Enter")e==null||e(j[x.current].text,{e:p});else{var r,h=x.current,N;p.code==="ArrowUp"||p.key==="ArrowUp"?N=h-1<0?j.length-1:h-1:(p.code==="ArrowDown"||p.key==="ArrowDown")&&(N=h+1>=j.length?0:h+1),P((r=j[N])===null||r===void 0?void 0:r.text)}},R=function(){ge(document,"keydown",F)},_=function(){he(document,"keydown",F)};return f.useImperativeHandle(s,function(){return{addKeyboardListener:R,removeKeyboardListener:_}}),f.useEffect(function(){return u?R():_(),function(){_()}},[u]),f.useEffect(function(){n||P("")},[n]),f.useEffect(function(){x.current=j.findIndex(function(i){return i.text===y})},[y,j]),j.length?w.createElement("ul",{className:E},j.map(function(i){var p=[].concat(V);i.text===y&&p.push("".concat(b,"-select-option--hover"));var r=(ve(i.label)?i.label():i.label)||i.text;return w.createElement("li",{key:i.text,className:K(p),title:i.text,onClick:z},typeof r=="string"&&t.highlightKeyword?w.createElement(Y,{content:r,keyword:n}):r)})):null});Z.displayName="OptionsList";/**
 * tdesign v1.4.1
 * (c) 2023 tdesign
 * @license MIT
 */function q(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);s&&(e=e.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),n.push.apply(n,e)}return n}function v(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?q(Object(n),!0).forEach(function(e){$(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var ee=f.forwardRef(function(t,s){var n,e=be(t,Le),u=f.useRef(),C=f.useRef(),b=ye(e,"value",e.onChange),g=D(b,2),m=g[0],y=g[1],P=Ce(),x=P.classPrefix,E=P.sizeClassNames,V=xe("input"),j=D(V,1),z=j[0],F=f.useState(!1),R=D(F,2),_=R[0],i=R[1],p=f.useRef(null);f.useImperativeHandle(s,function(){return{inputRef:u.current,popupRef:C.current}});var r=function(l,c){var a,L=l.getBoundingClientRect().width||l.offsetWidth||l.clientWidth,S=c.getBoundingClientRect().width||c.offsetWidth||c.clientWidth;return v({width:L>=S?"".concat(L,"px"):"auto"},(a=e.popupProps)===null||a===void 0?void 0:a.overlayInnerStyle)},h=["".concat(x,"-auto-complete")].concat(e.className),N=function(d){var l=["".concat(x,"-select__dropdown")];return(d=e.popupProps)!==null&&d!==void 0&&d.overlayClassName&&(l=l.concat(e.popupProps.overlayClassName)),K(l)}(),te=function(d){var l=["".concat(x,"-select__dropdown-inner")];return(d=e.popupProps)!==null&&d!==void 0&&d.overlayInnerClassName&&(l=l.concat(e.popupProps.overlayInnerClassName)),K(l)}(),ne=function(l,c){y(l,c)},re=function(){var d=v({value:m,size:e.size},e.inputProps);return d}(),oe=function(l,c){var a;i(!0),(a=e.onFocus)===null||a===void 0||a.call(e,v(v({},c),{},{value:l}));var L=setTimeout(function(){var S;(S=p.current)===null||S===void 0||S.addKeyboardListener(),clearTimeout(L)},0)},ae=function(l,c){var a;(a=e.onBlur)===null||a===void 0||a.call(e,v(v({},c),{},{value:l}))},le=function(l,c){var a;(a=e.onEnter)===null||a===void 0||a.call(e,v(v({},c),{},{value:l}))},se=function(l,c){var a;(a=e.onCompositionend)===null||a===void 0||a.call(e,v(v({},c),{},{value:l}))},ie=function(l,c){var a;(a=e.onCompositionstart)===null||a===void 0||a.call(e,v(v({},c),{},{value:l}))},ce=function(l,c){var a;e.readonly||e.disabled||(i(!1),y(l,c),(a=e.onSelect)===null||a===void 0||a.call(e,l,c))},ue=function(l,c){var a=c.trigger;a!=="trigger-element-click"&&i(l)},pe=e.triggerElement||e.children||w.createElement(A,v({ref:u,placeholder:(n=e.placeholder)!==null&&n!==void 0?n:z.placeholder,tips:e.tips,status:e.status,readonly:e.readonly,disabled:e.disabled,clearable:e.clearable,autofocus:e.autofocus,onClear:e.onClear,onChange:ne,onFocus:oe,onBlur:ae,onEnter:le,onCompositionend:se,onCompositionstart:ie},re)),B=Array.isArray(e.options)&&w.createElement(Z,{ref:p,value:m,options:e.options,size:e.size,sizeClassNames:E,onSelect:ce,popupVisible:_,highlightKeyword:e.highlightKeyword,filterable:e.filterable,filter:e.filter}),T=e.panelTopContent,W=e.panelBottomContent,de=T||B||W?w.createElement("div",{className:"".concat(x,"-autocomplete__panel")},T,B,W):null,fe=v(v({},e.popupProps),{},{overlayInnerStyle:r,overlayInnerClassName:te,overlayClassName:N});return w.createElement("div",{className:K(h),style:e.style},w.createElement(je,v({ref:C,visible:_,onVisibleChange:ue,trigger:"focus",placement:"bottom-left",hideEmptyPopup:!0,content:de},fe),pe))});ee.displayName="AutoComplete";/**
 * tdesign v1.4.1
 * (c) 2023 tdesign
 * @license MIT
 */var Ve=ee;const nt=()=>{const t=we(),{id:s}=Pe(),{data:n,isLoading:e}=Oe({resource:"content.category"}),u=(n==null?void 0:n.data)||[],[C]=O.useForm(),b=O.useWatch("class_id",C),{request:g}=Ee(),[m,y]=f.useState();f.useEffect(()=>{if(!b){y(void 0);return}g(`content/category/${b}/magic`,"get").then(E=>{y((E==null?void 0:E.data)||{})})},[b]);const{options:P}=M({resource:"content.source",optionLabel:"name",optionValue:"id"}),{options:x}=M({resource:"content.recommend",optionLabel:"name",optionValue:"id"});return o.jsxs(Ie,{formProps:{labelAlign:"top"},back:!0,form:C,id:s,settingRender:o.jsxs(o.Fragment,{children:[o.jsx(O.FormItem,{label:t("content.article.fields.subtitle"),name:"subtitle",children:o.jsx(A,{})}),o.jsx(O.FormItem,{label:t("content.article.fields.image"),name:"images",children:o.jsx(Re,{accept:"image/*"})}),o.jsx(O.FormItem,{label:t("content.article.fields.imagesAuto"),name:"images_auto",initialData:!0,children:o.jsxs(I.Group,{children:[o.jsx(I,{value:!0,children:t("content.article.fields.auto")}),o.jsx(I,{value:!1,children:t("content.article.fields.manual")})]})}),o.jsx(O.FormItem,{label:t("content.article.fields.recommend"),name:"recommend",children:o.jsx(_e.Group,{options:x})}),o.jsx(O.FormItem,{label:t("content.article.fields.source"),name:"source",children:o.jsx(Ve,{options:P,highlightKeyword:!0,filterable:!1,clearable:!0})}),(m==null?void 0:m.fields)&&o.jsx(Se,{fields:m==null?void 0:m.fields,prefix:"extend"}),o.jsx(O.FormItem,{label:t("content.article.fields.status"),name:"status",initialData:!0,children:o.jsxs(I.Group,{children:[o.jsx(I,{value:!0,children:t("content.article.tab.published")}),o.jsx(I,{value:!1,children:t("content.article.tab.unpublished")})]})})]}),children:[o.jsx(k,{name:"class_id",children:o.jsx(ke,{loading:e,options:u,keys:{label:"name",value:"id"},clearable:!0,checkStrictly:!0,placeholder:t("content.article.validate.class")})}),o.jsx(k,{name:"title",children:o.jsx(A,{placeholder:t("content.article.validate.title")})}),o.jsx(k,{name:"content",children:o.jsx(Ne,{})}),o.jsx(k,{name:"keyword",children:o.jsx(A,{placeholder:t("content.article.validate.keywords")})}),o.jsx(k,{name:"descriptions",initialData:"",children:o.jsx(Fe,{placeholder:t("content.article.validate.descriptions")})})]})};export{nt as default};
