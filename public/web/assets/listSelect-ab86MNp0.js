import{j as e}from"./vendor-map-DEYI1At9.js";import{_ as K,aA as E}from"./vendor-refine-N0YDYeEW.js";import{r as l}from"./vendor-react-BlTfyhut.js";import{O as F,a1 as N,Y as S,P as D}from"./modulepreload-polyfill-qjA-9dc5.js";import{B as b,K as k,F as R,I as T,T as V}from"./vendor-tdesign-6RiSygsd.js";const z=({options:d,resource:r,table:t,tableHook:m,tableColumns:i,sort:o,...n})=>{const u=K(),[p,f]=F(n),[h,a]=l.useState(!1),[x,g]=l.useState([]),{data:c}=E({resource:r,ids:p||[]});return l.useEffect(()=>{g((c==null?void 0:c.data)||[])},[c]),l.useEffect(()=>{f(x.map(s=>s==null?void 0:s.id))},[x]),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{children:e.jsx(b,{variant:"outline",theme:"primary",onClick:()=>a(!0),icon:e.jsx("div",{className:"t-icon i-tabler:plus"}),children:u("common.select")})}),e.jsxs("div",{className:"mt-3",children:[e.jsx(N,{createAction:!1,deleteAction:!0,value:x,options:d||[],rowKey:"id",onChange:s=>{g(s)},sort:o}),e.jsx(A,{open:h,onClose:()=>a(!1),table:t,tableHook:m,columns:i,resource:r,onSelect:s=>{g(y=>{const j=y||[];return s==null||s.forEach(w=>{j.some(C=>C.id==w.id)||j.push(w)}),[...j]})}})]})]})},A=({resource:d,columns:r,table:t,tableHook:m,open:i,onClose:o,onSelect:n})=>{const u=K(),[p,f]=l.useState([]);return e.jsx(k,{header:u("common.select"),visible:i,onClose:o,className:"app-modal",destroyOnClose:!0,width:800,onConfirm:()=>{n==null||n(p),o==null||o()},children:e.jsx(B,{resource:d,columns:r,table:t,tableHook:m,onSelect:h=>f(h||[])})})},B=({resource:d,columns:r,table:t,tableHook:m,onSelect:i})=>{const o=K(),n=l.useMemo(()=>r?[{colKey:"row-select",type:"multiple",width:50},...r]:[],[r]),{data:u,pagination:p,selecteds:f,setSelecteds:h,selectOptions:a,sorters:x,setSorters:g,filters:c,setFilters:s,tableFilters:y,setTableFilters:j,loading:w}=S({pagination:{current:0,pageSize:10},columns:n,rowKey:t==null?void 0:t.rowKey,resource:d,...m});return l.useEffect(()=>{i==null||i((a==null?void 0:a.selectedRowData)||[])},[a==null?void 0:a.selectedRowData]),e.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-0",children:[e.jsx(R,{initialData:c,labelWidth:0,className:"app-filter flex-wrap",onValuesChange:C=>{s(C)},children:e.jsx(D,{name:"keyword",children:e.jsx(T,{placeholder:o("common.placeholderKeyword")})})}),e.jsx(V,{bordered:!0,rowKey:(t==null?void 0:t.rowKey)||"id",columns:n,data:u,cellEmptyContent:"-",stripe:!0,showSortColumnBgColor:!0,loading:w,pagination:{...p,className:"app-pagination"},sort:x,onSortChange:g,selectedRowKeys:f,onSelectChange:h,filterValue:y,onFilterChange:j,...t})]})};export{z as L};
