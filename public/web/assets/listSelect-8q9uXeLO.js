import{X as K,au as N,g as i,b_ as E,j as e,J as S,b$ as b,aN as F,a9 as D,P as k,ae as R,Q as V,c0 as L}from"./modulepreload-polyfill-DkiKXnSB.js";const H=({options:d,resource:r,table:s,tableHook:u,tableColumns:l,sort:o,...n})=>{const m=K(),[p,h]=N(n),[f,a]=i.useState(!1),[x,g]=i.useState([]),{data:c}=E({resource:r,ids:p||[]});return i.useEffect(()=>{g((c==null?void 0:c.data)||[])},[c]),i.useEffect(()=>{h(x.map(t=>t==null?void 0:t.id))},[x]),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{children:e.jsx(S,{variant:"outline",theme:"primary",onClick:()=>a(!0),icon:e.jsx("div",{className:"t-icon i-tabler:plus"}),children:m("common.select")})}),e.jsxs("div",{className:"mt-3",children:[e.jsx(b,{createAction:!1,deleteAction:!0,value:x,options:d||[],rowKey:"id",onChange:t=>{g(t)},sort:o}),e.jsx(T,{open:f,onClose:()=>a(!1),table:s,tableHook:u,columns:l,resource:r,onSelect:t=>{g(y=>{const j=y||[];return t==null||t.forEach(w=>{j.some(C=>C.id==w.id)||j.push(w)}),[...j]})}})]})]})},T=({resource:d,columns:r,table:s,tableHook:u,open:l,onClose:o,onSelect:n})=>{const m=K(),[p,h]=i.useState([]);return e.jsx(F,{header:m("common.select"),visible:l,onClose:o,className:"app-modal",destroyOnClose:!0,width:800,onConfirm:()=>{n==null||n(p),o==null||o()},children:e.jsx(A,{resource:d,columns:r,table:s,tableHook:u,onSelect:f=>h(f||[])})})},A=({resource:d,columns:r,table:s,tableHook:u,onSelect:l})=>{const o=K(),n=i.useMemo(()=>r?[{colKey:"row-select",type:"multiple",width:50},...r]:[],[r]),{data:m,pagination:p,selecteds:h,setSelecteds:f,selectOptions:a,sorters:x,setSorters:g,filters:c,setFilters:t,tableFilters:y,setTableFilters:j,loading:w}=D({pagination:{current:0,pageSize:10},columns:n,rowKey:s==null?void 0:s.rowKey,resource:d,...u});return i.useEffect(()=>{l==null||l((a==null?void 0:a.selectedRowData)||[])},[a==null?void 0:a.selectedRowData]),e.jsxs("div",{className:"flex flex-col gap-4 p-4 pb-0",children:[e.jsx(k,{initialData:c,labelWidth:0,className:"app-filter flex-wrap",onValuesChange:C=>{t(C)},children:e.jsx(R,{name:"keyword",children:e.jsx(V,{placeholder:o("common.placeholderKeyword")})})}),e.jsx(L,{bordered:!0,rowKey:(s==null?void 0:s.rowKey)||"id",columns:n,data:m,cellEmptyContent:"-",stripe:!0,showSortColumnBgColor:!0,loading:w,pagination:{...p,className:"app-pagination"},sort:x,onSortChange:g,selectedRowKeys:h,onSelectChange:f,filterValue:y,onFilterChange:j,...s})]})};export{H as L};
