import{j as e}from"./vendor-map-DEYI1At9.js";import{_ as V,av as E}from"./vendor-refine-N0YDYeEW.js";import{B as j,c as I}from"./button-DAYx5G5K.js";import{a2 as N}from"./modulepreload-polyfill-qjA-9dc5.js";import{r}from"./vendor-react-BlTfyhut.js";import{F as m,S}from"./vendor-tdesign-6RiSygsd.js";const y=({form:t,field:a,title:F,resource:n,component:c,optionLabel:g,optionValue:v,defaultSelect:u})=>{const d=V(),[x,p]=r.useState(!1),{options:s,onSearch:b,queryResult:C}=E({resource:n,optionLabel:g||"name",optionValue:v||"id"}),l=r.useContext(N);r.useEffect(()=>{var i,h;!u||!s.length||!l||x||(p(()=>!0),t==null||t.setFieldsValue({[a]:(i=s[0])==null?void 0:i.value}),l.setFilters({[a]:(h=s[0])==null?void 0:h.value}),console.log(t==null?void 0:t.getFieldValue(a)))},[u,a,t,x,s,l]);const o=m.useWatch(a,t);return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(j,{resource:n,action:"create",variant:"outline",theme:"default",title:d("buttons.create"),icon:e.jsx("div",{className:"i-tabler:plus"}),component:c,children:e.jsx(e.Fragment,{})})}),e.jsx(m.FormItem,{name:a,children:e.jsx(S,{clearable:!0,onSearch:b,options:s,placeholder:F,loading:C.isLoading})}),o&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{resource:n,action:"edit",variant:"outline",theme:"default",title:d("tools.magic.fields.editGroup"),icon:e.jsx("div",{className:"i-tabler:edit"}),component:c,rowId:o,children:e.jsx(e.Fragment,{})}),e.jsx(I,{resource:n,variant:"outline",theme:"default",icon:e.jsx("div",{className:"i-tabler:trash"}),rowId:o,onConfirm:()=>{setTimeout(()=>{var i;t.getFieldValue(a)&&(t==null||t.setFieldsValue({[a]:(i=s[0])==null?void 0:i.value}))},0),p(!1)},children:e.jsx(e.Fragment,{})})]})]})};export{y as F};
